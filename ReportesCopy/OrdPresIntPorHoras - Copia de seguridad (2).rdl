<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <DataSources>
    <DataSource Name="Nomina">
      <rd:DataSourceID>98331b76-1050-4be6-85ef-bd386c4b0d4d</rd:DataSourceID>
      <DataSourceReference>Nomina</DataSourceReference>
    </DataSource>
    <DataSource Name="Admon">
      <rd:DataSourceID>386d8e2c-a1c6-4da0-8ff1-95d9561ef314</rd:DataSourceID>
      <DataSourceReference>Admon</DataSourceReference>
    </DataSource>
  </DataSources>
  <InteractiveHeight>27.94cm</InteractiveHeight>
  <ReportParameters>
    <ReportParameter Name="pIdOrdenDePres">
      <DataType>Integer</DataType>
      <AllowBlank>true</AllowBlank>
      <Prompt>IdOrdenDePres</Prompt>
    </ReportParameter>
    <ReportParameter Name="pIdQnaIni">
      <DataType>Integer</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>dsEfectos</DataSetName>
          <ValueField>IdQnaIni</ValueField>
        </DataSetReference>
      </DefaultValue>
      <AllowBlank>true</AllowBlank>
    </ReportParameter>
    <ReportParameter Name="pIdEmp">
      <DataType>Integer</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>dsEmpleado</DataSetName>
          <ValueField>IdEmp</ValueField>
        </DataSetReference>
      </DefaultValue>
      <AllowBlank>true</AllowBlank>
    </ReportParameter>
    <ReportParameter Name="pIdUsuarioCreador">
      <DataType>Integer</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>dsOrdenDePres</DataSetName>
          <ValueField>IdUsuarioCreador</ValueField>
        </DataSetReference>
      </DefaultValue>
      <AllowBlank>true</AllowBlank>
    </ReportParameter>
  </ReportParameters>
  <rd:DrawGrid>true</rd:DrawGrid>
  <InteractiveWidth>21.59cm</InteractiveWidth>
  <rd:GridSpacing>0.15cm</rd:GridSpacing>
  <rd:SnapToGrid>false</rd:SnapToGrid>
  <PageHeader>
    <PrintOnFirstPage>true</PrintOnFirstPage>
    <ReportItems>
      <Image Name="image1">
        <Sizing>Fit</Sizing>
        <Width>20cm</Width>
        <MIMEType />
        <Source>External</Source>
        <Style />
        <Left>0.795cm</Left>
        <Value>headerformatos.png</Value>
      </Image>
    </ReportItems>
    <Height>3cm</Height>
    <PrintOnLastPage>true</PrintOnLastPage>
  </PageHeader>
  <rd:ReportID>e6fc191f-b535-49e3-9ce0-5059c5831c55</rd:ReportID>
  <PageWidth>21.59cm</PageWidth>
  <DataSets>
    <DataSet Name="dsEmpleado">
      <Fields>
        <Field Name="NomEmp">
          <DataField>NomEmp</DataField>
        </Field>
        <Field Name="Sexo">
          <DataField>Sexo</DataField>
        </Field>
        <Field Name="Nombramiento">
          <DataField>Nombramiento</DataField>
        </Field>
        <Field Name="AbrevTipoEmp">
          <DataField>AbrevTipoEmp</DataField>
        </Field>
        <Field Name="Categoria">
          <DataField>Categoria</DataField>
        </Field>
        <Field Name="IdPlantel">
          <DataField>IdPlantel</DataField>
        </Field>
        <Field Name="DescPlantel">
          <DataField>DescPlantel</DataField>
        </Field>
        <Field Name="IdEmp">
          <DataField>IdEmp</DataField>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>Nomina</DataSourceName>
        <CommandText>Select 
	E.IdEmp, RTRIM(LTRIM(E.NomEmp + ' ' + IsNull(E.ApePatEmp,'') + ' ' + IsNull(E.ApeMatEmp,''))) NomEmp, 
	Right(Left(E.CURPEmp,11),1) Sexo,
	Case
		When N.AbrevNombramiento = 'I' Then 'Interinamente'
		When N.AbrevNombramiento = 'P' Then 'Provisionalmente'
		Else ''
	End Nombramiento,
	N.AbrevNombramiento, LTRIM(RTRIM(C.DescCategoria)) Categoria,
	P.IdPlantel, P.DescPlantel
From Horas H
	Inner Join
			(
				Select Top 1 OPH.*
				From OrdenesDePresentacionHoras OPH
				Where OPH.IdOrdenDePres = @IdOrdenDePres
			) A On A.IdHora = H.IdHora
	Inner Join Empleados E On E.IdEmp = H.IdEmp
	Inner Join Nombramientos N ON N.IdNombramiento = H.IdNombramiento
	Inner Join TiposDeHoraDocentes THD On THD.IdTipoHora = H.IdTipoHora
	Inner Join Categorias C On C.IdCategoria = THD.IdCategoria
	Inner Join Planteles P On P.IdPlantel = H.IdPlantel</CommandText>
        <QueryParameters>
          <QueryParameter Name="@IdOrdenDePres">
            <Value>=Parameters!pIdOrdenDePres.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="dsEfectos">
      <Fields>
        <Field Name="EfectoIni">
          <DataField>EfectoIni</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="EfectoFin">
          <DataField>EfectoFin</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="IdQnaIni">
          <DataField>IdQnaIni</DataField>
          <rd:TypeName>System.Int16</rd:TypeName>
        </Field>
        <Field Name="IdQnaFin">
          <DataField>IdQnaFin</DataField>
          <rd:TypeName>System.Int16</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>Nomina</DataSourceName>
        <CommandText>Set DateFormat dmy

Declare @IdQnaIni Smallint
Declare @IdQnaFin Smallint
Declare @IdEmp Int
Declare @DiasPagoQnaIni Tinyint
Declare @QnaIni Tinyint
Declare @AnioIni Smallint
Declare @DiaIni Tinyint
Declare @MesIni Tinyint
Declare @QnaFin Tinyint
Declare @AnioFin Smallint
Declare @DiaFin Tinyint
Declare @MesFin Tinyint
Declare @NumDiasMesIni Tinyint
Declare @EfectoIni NVarchar(100)
Declare @EfectoFin NVarchar(100)

Select Top 1 @IdEmp = H.IdEmp, @IdQnaIni = H.IdQuincenaIni, @IdQnaFin = H.IdQuincenaFin
From OrdenesDePresentacionHoras OPH
	Inner Join Horas H On H.IdHora = OPH.IdHora
Where OPH.IdOrdenDePres = @IdOrdenDePres

Select @DiasPagoQnaIni = NumDiasAPagar
From EmpsDiasParaPagoQnal
Where IdEmp = @IdEmp And IdQuincena = @IdQnaIni

Select @AnioIni = Anio, @QnaIni = Quincena
From Quincenas
Where IdQuincena = @IdQnaIni

If @DiasPagoQnaIni Is Null
	Begin
		If @QnaIni % 2 = 0
			Begin
				Set @DiaIni = 16
				Set @MesIni = @QnaIni/2
			End
		Else
			Begin
				Set @DiaIni = 1
				Set @MesIni = (@QnaIni+1)/2
			End
	End
Else
	Begin		
		If @QnaIni % 2 = 0
			Begin
				Set @MesIni = @QnaIni/2

				Set @DiaIni = (30 - @DiasPagoQnaIni) + 1
			End
		Else
			Begin
				Set @DiaIni = (15 - @DiasPagoQnaIni) + 1
				Set @MesIni = (@QnaIni+1)/2
			End
	End
	
Select @AnioFin = Anio, @QnaFin = Quincena
From Quincenas
Where IdQuincena = @IdQnaFin

If @QnaFin % 2 = 0
	Begin
		Set @MesFin = @QnaFin/2
		
		If dbo.Fn_ObtenSiAnioEsBisiesto(@AnioFin) = 1 And @MesFin = 2
			Begin
				Set @DiaFin = 29
			End
		Else
			Begin
				Select @DiaFin = NumDiasMes
				From Meses
				Where IdMes = @MesFin
			End
	End
Else
	Begin
		Set @DiaFin = 15
		Set @MesFin = (@QnaFin+1)/2
	End
	
Select @EfectoIni = Convert(NVarchar(2), @DiaIni) + ' de '  + NombreMes + ' de ' +  Convert(NVarchar(4), @AnioIni)
From Meses
Where IdMes = @MesIni

Select @EfectoFin = Convert(NVarchar(2), @DiaFin) + ' de '  + NombreMes + ' de ' +  Convert(NVarchar(4), @AnioFin)
From Meses
Where IdMes = @MesFin

Select @EfectoIni EfectoIni, @EfectoFin EfectoFin, @IdQnaIni IdQnaIni, @IdQnaFin IdQnaFin</CommandText>
        <QueryParameters>
          <QueryParameter Name="@IdOrdenDePres">
            <Value>=Parameters!pIdOrdenDePres.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="dsEmpleadoTitular">
      <Fields>
        <Field Name="NomEmp">
          <DataField>NomEmp</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="DescParaFormatos">
          <DataField>DescParaFormatos</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>Nomina</DataSourceName>
        <CommandText>Select Top 1 
	RTRIM(LTRIM(E.NomEmp + ' ' + E.ApePatEmp + ' ' + E.ApeMatEmp)) NomEmp,
	Upper(MHI.DescParaFormatos) DescParaFormatos
From OrdenesDePresentacionHoras OPH
	Inner Join HorasInterinas HI On HI.IdHora = OPH.IdHora
	Inner Join Empleados E On E.IdEmp = HI.IdEmp
	Inner Join MotivosHorasInterinas MHI On MHI.IdMotivoHoraInterina = HI.IdMotivoHoraInterina
Where OPH.IdOrdenDePres = @IdOrdenDePres</CommandText>
        <QueryParameters>
          <QueryParameter Name="@IdOrdenDePres">
            <Value>=Parameters!pIdOrdenDePres.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="dsFirmanteOP">
      <Fields>
        <Field Name="Profesion">
          <DataField>Profesion</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="DirectorAdmvo">
          <DataField>DirectorAdmvo</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Orden">
          <DataField>Orden</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>Nomina</DataSourceName>
        <CommandText>Select T1.*
From (
	Select LTRIM(RTRIM(IsNull(P.AbrevProfesion, 'LIC.'))) Profesion,
		LTRIM(RTRIM(IsNull(E.NomEmp,'') + ' ' +  IsNull(E.ApePatEmp,'') + ' ' + IsNull(E.ApeMatEmp,''))) DirectorAdmvo,
		1 Orden
	From EmpleadosPlazas EP
		Inner Join PlazasHistoria PH On PH.IdPlaza = EP.IdPlaza
		Inner Join CentrosDeTrabajo CT On CT.IdCT = EP.IdCT
		Inner Join Empleados E On E.IdEmp = EP.IdEmp
		Left Join EmpleadosDatosAcademicos EDA On EDA.IdEmp = E.IdEmp
		Left Join Profesiones P On P.IdProfesion = EDA.IdProfesion
	Where Left(dbo.Fn_ObtenQnaPorId(@IdQnaIni),6) Between Left(dbo.Fn_ObtenQnaPorId(PH.IdQnaVigIni),6) And Left(dbo.Fn_ObtenQnaPorId(PH.IdQnaVigFin),6)
		And CT.IdCT In (4,119) And EP.IdCategoria In (2)
	Union All
	Select LTRIM(RTRIM(IsNull(P.AbrevProfesion, 'LIC.'))) Profesion,
		LTRIM(RTRIM(IsNull(E.NomEmp,'') + ' ' +  IsNull(E.ApePatEmp,'') + ' ' + IsNull(E.ApeMatEmp,''))) DirectorAdmvo,
		2 Orden
	From EmpleadosPlazas EP
		Inner Join PlazasHistoria PH On PH.IdPlaza = EP.IdPlaza
		Inner Join CentrosDeTrabajo CT On CT.IdCT = EP.IdCT
		Inner Join Empleados E On E.IdEmp = EP.IdEmp
		Left Join EmpleadosDatosAcademicos EDA On EDA.IdEmp = E.IdEmp
		Left Join Profesiones P On P.IdProfesion = EDA.IdProfesion
	Where Left(dbo.Fn_ObtenQnaPorId(@IdQnaIni),6) Between Left(dbo.Fn_ObtenQnaPorId(PH.IdQnaVigIni),6) And Left(dbo.Fn_ObtenQnaPorId(PH.IdQnaVigFin),6)
		And CT.IdCT In (5,120) And EP.IdCategoria In (10)
	) T1
Order By T1.Orden Asc</CommandText>
        <QueryParameters>
          <QueryParameter Name="@IdQnaIni">
            <Value>=Parameters!pIdQnaIni.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="dsCopiaSindicato">
      <Fields>
        <Field Name="Profesion">
          <DataField>Profesion</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="NomEmp">
          <DataField>NomEmp</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Cargo">
          <DataField>Cargo</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="IdSindicato">
          <DataField>IdSindicato</DataField>
          <rd:TypeName>System.Byte</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>Nomina</DataSourceName>
        <CommandText>Declare @IdOrigenPropuesta Tinyint

Select @IdOrigenPropuesta = IdOrigenPropuesta
From OrdenesDePresentacion
Where IdOrdenDePres = @IdOrdenDePres

Select LTRIM(RTRIM(IsNull(P.AbrevProfesion, 'LIC.'))) Profesion,
	RTRIM(LTRIM(IsNull(E.NomEmp,'') + ' ' + IsNull(E.ApePatEmp,'') + ' ' + IsNull(E.ApeMatEmp,''))) NomEmp,
	Case
		When  Right(Left(E.CURPEmp,11),1) = 'M' Then 'SECRETARIA GENERAL DEL ' + LTRIM(RTRIM(S.SiglasSindicato))
		When  Right(Left(E.CURPEmp,11),1) = 'H' Then 'SECRETARIO GENERAL DEL ' + LTRIM(RTRIM(S.SiglasSindicato))
	End Cargo, S.IdSindicato
From HistoriaLideresSindicales HLS
	Inner Join Sindicatos S On S.IdSindicato = HLS.IdSindicato
	Inner Join Empleados E On E.IdEmp = HLS.IdEmp
	Left Join EmpleadosDatosAcademicos EDA On EDA.IdEmp = E.IdEmp
	Left Join Profesiones P On P.IdProfesion = EDA.IdProfesion
Where HLS.IdSindicato = @IdOrigenPropuesta And
	Left(dbo.Fn_ObtenQnaPorId(@IdQnaIni),6) Between Left(dbo.Fn_ObtenQnaPorId(HLS.IdQnaIni),6) And Left(dbo.Fn_ObtenQnaPorId(HLS.IdQnaFin),6)</CommandText>
        <QueryParameters>
          <QueryParameter Name="@IdOrdenDePres">
            <Value>=Parameters!pIdOrdenDePres.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@IdQnaIni">
            <Value>=Parameters!pIdQnaIni.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="dsTitularCT">
      <Fields>
        <Field Name="Profesion">
          <DataField>Profesion</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="NomEmp">
          <DataField>NomEmp</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Cargo">
          <DataField>Cargo</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="NombreCT">
          <DataField>NombreCT</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>Nomina</DataSourceName>
        <CommandText>Declare @IdCT Smallint

Select @IdCT = EP.IdCT
From EmpleadosPlazas EP
	Inner Join PlazasHistoria PH On PH.IdPlaza = EP.IdPlaza
Where Left(dbo.Fn_ObtenQnaPorId(@IdQnaIni),6) Between Left(dbo.Fn_ObtenQnaPorId(PH.IdQnaVigIni),6) And Left(dbo.Fn_ObtenQnaPorId(PH.IdQnaVigFin),6)
	And EP.PlazaEspecial = 0 And EP.IdEmp = @IdEmp

Select LTRIM(RTRIM(IsNull(P.AbrevProfesion, 'LIC.'))) Profesion,
	LTRIM(RTRIM(IsNull(E.NomEmp,'') + ' ' +  IsNull(E.ApePatEmp,'') + ' ' + IsNull(E.ApeMatEmp,''))) NomEmp,
	CT.DescDelTitular Cargo, 
	Case
		When CT.IdTipoCT = 7 Then 'Plantel ' + Right(CT.ClaveCT,2) + '-' + CT.NombreCT
		Else CT.NombreCT
	End NombreCT
From EmpleadosPlazas EP
	Inner Join PlazasHistoria PH On PH.IdPlaza = EP.IdPlaza
	Inner Join CentrosDeTrabajo CT On CT.IdCT = EP.IdCT
	Inner Join Empleados E On E.IdEmp = EP.IdEmp
	Left Join EmpleadosDatosAcademicos EDA On EDA.IdEmp = E.IdEmp
	Left Join Profesiones P On P.IdProfesion = EDA.IdProfesion
Where Left(dbo.Fn_ObtenQnaPorId(@IdQnaIni),6) Between Left(dbo.Fn_ObtenQnaPorId(PH.IdQnaVigIni),6) And Left(dbo.Fn_ObtenQnaPorId(PH.IdQnaVigFin),6)
	And EP.IdFuncionPri Not In (6,8,9,10,11) And EP.IdTipoNomina = 1
	And EP.IdCT = @IdCT
Order By  CT.DescDelTitular</CommandText>
        <QueryParameters>
          <QueryParameter Name="@IdQnaIni">
            <Value>=Parameters!pIdQnaIni.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@IdEmp">
            <Value>=Parameters!pIdEmp.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="dsOrdenDePres">
      <Fields>
        <Field Name="OficioDePropuesta">
          <DataField>OficioDePropuesta</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="FchParaOrdDePres">
          <DataField>FchParaOrdDePres</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="NumOrdPres">
          <DataField>NumOrdPres</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="NumRomanoZonaGeo">
          <DataField>NumRomanoZonaGeo</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Ejercicio">
          <DataField>Ejercicio</DataField>
          <rd:TypeName>System.Int16</rd:TypeName>
        </Field>
        <Field Name="IdUsuarioCreador">
          <DataField>IdUsuarioCreador</DataField>
          <rd:TypeName>System.Int16</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>Nomina</DataSourceName>
        <CommandText>Select Top 1 IsNull(OP.OficioDePropuesta,'') OficioDePropuesta, OP.FchParaOrdDePres, OP.NumOrdPres,
	ZG.NumRomanoZonaGeo, OP.Ejercicio, OP.IdUsuarioCreador
From OrdenesDePresentacion OP
	Inner Join OrdenesDePresentacionHoras OPH On OPH.IdOrdenDePres = OP.IdOrdenDePres
	Inner Join Horas H On H.IdHora = OPH.IdHora
	Inner Join Planteles P On P.IdPlantel = H.IdPlantel
	Inner Join ZonasGeograficas ZG On ZG.IdZonaGeografica = P.IdZonaGeografica
Where OP.IdOrdenDePres = @IdOrdenDePres</CommandText>
        <QueryParameters>
          <QueryParameter Name="@IdOrdenDePres">
            <Value>=Parameters!pIdOrdenDePres.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="dsCargaHorariaOP">
      <Fields>
        <Field Name="IdRegistro">
          <DataField>IdRegistro</DataField>
          <rd:TypeName>System.Byte</rd:TypeName>
        </Field>
        <Field Name="IdMateria">
          <DataField>IdMateria</DataField>
          <rd:TypeName>System.Int16</rd:TypeName>
        </Field>
        <Field Name="NombreMateria">
          <DataField>NombreMateria</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="IdGrupo">
          <DataField>IdGrupo</DataField>
          <rd:TypeName>System.Byte</rd:TypeName>
        </Field>
        <Field Name="Grupo">
          <DataField>Grupo</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Cantidad">
          <DataField>Cantidad</DataField>
          <rd:TypeName>System.Byte</rd:TypeName>
        </Field>
        <Field Name="IdCategoria">
          <DataField>IdCategoria</DataField>
          <rd:TypeName>System.Int16</rd:TypeName>
        </Field>
        <Field Name="DescCategoria">
          <DataField>DescCategoria</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Veces">
          <DataField>Veces</DataField>
          <rd:TypeName>System.Byte</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>Nomina</DataSourceName>
        <CommandText>Declare @TblCargaHoraria Table
	(IdRegistro Tinyint Identity, IdMateria Smallint, NombreMateria NVarchar(100),
	IdGrupo Tinyint, Grupo NVarchar(50), Cantidad Tinyint,
	IdCategoria Smallint, DescCategoria NVarchar(50), Veces Tinyint)
Declare @TblGrupos Table
	(IdRegistro Tinyint, IdGrupo Tinyint)

Declare @IdHora Int	
Declare @IdMateria Smallint, @IdCategoria Smallint
Declare @IdGrupo Tinyint, @Cantidad Tinyint, @IdRegistro Tinyint
Declare @Grupo NVarchar(3), @Grupo_Aux NVarchar(50)

Declare _Cursor Cursor For
	Select OPH.IdHora
	From OrdenesDePresentacionHoras OPH
	Where IdOrdenDePres = @IdOrdenDePres

Open _Cursor
Fetch Next From _Cursor
Into @IdHora
While @@Fetch_Status = 0
	Begin
		Select @IdMateria = H.IdMateria, @IdGrupo = H.IdGrupo, @Cantidad = H.Cantidad, @IdCategoria = C.IdCategoria
		From Horas H
			Inner Join TiposDeHoraDocentes THD On THD.IdTipoHora = H.IdTipoHora
			Inner Join Categorias C On C.IdCategoria = THD.IdCategoria
		Where H.IdHora = @IdHora
		
		If Not Exists
					(
						Select 1
						From @TblCargaHoraria
						Where IdMateria = @IdMateria And Cantidad = @Cantidad And IdCategoria = @IdCategoria
					)
			Begin
				Insert Into @TblCargaHoraria
				Select M.IdMateria, M.NombreMateria, G.IdGrupo, G.Grupo, H.Cantidad, C.IdCategoria, C.DescCategoria, 0 Veces
				From Horas H
					Inner Join Materias M On M.IdMateria = H.IdMateria
					Inner Join Grupos G On G.IdGrupo = H.IdGrupo
					Inner Join TiposDeHoraDocentes THD On THD.IdTipoHora = H.IdTipoHora
					Inner Join Categorias C On C.IdCategoria = THD.IdCategoria
				Where H.IdHora = @IdHora
				
				Insert Into @TblGrupos
				Select @@Identity, @IdGrupo
			End
		Else
			Begin
				Select @IdRegistro = IdRegistro
				From @TblCargaHoraria
				Where IdMateria = @IdMateria And Cantidad = @Cantidad And IdCategoria = @IdCategoria
									
				Select @IdGrupo = G.IdGrupo
				From Horas H
					Inner Join Grupos G On G.IdGrupo = H.IdGrupo
				Where H.IdHora = @IdHora
				
				Insert Into @TblGrupos
				Select @IdRegistro, @IdGrupo
			End
			
		Fetch Next From _Cursor
		Into @IdHora
	End
Close _Cursor
Deallocate _Cursor

Update @TblCargaHoraria
Set Grupo = ''

Declare _Cursor Cursor For
	Select A.IdRegistro, G.Grupo
	From @TblGrupos A
		Inner Join Grupos G On G.IdGrupo = A.IdGrupo
	Order By G.Grupo Asc
	
Open _Cursor
Fetch Next From _Cursor
Into @IdRegistro, @Grupo
While @@Fetch_Status = 0
	Begin
		Select @Grupo_Aux = Grupo
		From @TblCargaHoraria
		Where IdRegistro = @IdRegistro
		
		If @Grupo_Aux = ''
			Begin
				Set @Grupo_Aux = @Grupo
			End
		Else
			Begin
				Set @Grupo_Aux = @Grupo_Aux + ', ' + @Grupo
			End
			
		Update @TblCargaHoraria
		Set Grupo = @Grupo_Aux, Veces = Veces + 1
		Where IdRegistro = @IdRegistro
	
		Fetch Next From _Cursor
		Into @IdRegistro, @Grupo	
	End
Close _Cursor
Deallocate _Cursor

Select *
From @TblCargaHoraria</CommandText>
        <QueryParameters>
          <QueryParameter Name="@IdOrdenDePres">
            <Value>=Parameters!pIdOrdenDePres.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="dsUsuario">
      <Fields>
        <Field Name="Iniciales">
          <DataField>Iniciales</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>Admon</DataSourceName>
        <CommandText>Select Iniciales
From Usuarios
Where IdUsuario = @IdUsuario</CommandText>
        <QueryParameters>
          <QueryParameter Name="@IdUsuario">
            <Value>=Parameters!pIdUsuarioCreador.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
  </DataSets>
  <Author>Fabio Rodríguez López</Author>
  <Code>Public dim nombrevariable as String = ""

Public dim i as Integer = 0

Public Function FncCampoCabecera(byval valorCampo as String) as String
i = i  + 1
if i = 1 then
nombrevariable = valorCampo
end if
return nombrevariable
End Function</Code>
  <Width>21.59cm</Width>
  <Body>
    <ColumnSpacing>0.5cm</ColumnSpacing>
    <ReportItems>
      <Textbox Name="textbox5">
        <Top>18.06869cm</Top>
        <Width>16.26984cm</Width>
        <Style>
          <FontSize>8pt</FontSize>
          <TextAlign>Left</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>25</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>2.3823cm</Left>
        <Height>0.44974cm</Height>
        <Value>=First(Fields!Iniciales.Value, "dsUsuario")</Value>
      </Textbox>
      <Textbox Name="textbox38">
        <Top>14.27239cm</Top>
        <Width>8.5cm</Width>
        <Style>
          <FontSize>8pt</FontSize>
          <FontWeight>700</FontWeight>
          <TextAlign>Center</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>24</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>11.42198cm</Left>
        <Height>0.44974cm</Height>
        <Value>Vo.Bo.</Value>
      </Textbox>
      <Textbox Name="textbox39">
        <Top>13.53164cm</Top>
        <Width>8.5cm</Width>
        <Style>
          <FontSize>9pt</FontSize>
          <FontWeight>700</FontWeight>
          <TextAlign>Center</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>23</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>11.42198cm</Left>
        <Height>0.44974cm</Height>
        <Value>=Last(Fields!Profesion.Value, "dsFirmanteOP") + " " + Last(Fields!DirectorAdmvo.Value, "dsFirmanteOP")</Value>
      </Textbox>
      <Textbox Name="textbox40">
        <Top>13.98138cm</Top>
        <Width>8.5cm</Width>
        <Style>
          <BorderStyle>
            <Top>Solid</Top>
          </BorderStyle>
          <FontSize>8pt</FontSize>
          <FontWeight>700</FontWeight>
          <TextAlign>Center</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>22</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>11.42198cm</Left>
        <Height>0.44974cm</Height>
        <Value>DEPARTAMENTO DE RECURSOS HUMANOS</Value>
      </Textbox>
      <Textbox Name="textbox37">
        <Top>14.27239cm</Top>
        <Width>8.5cm</Width>
        <Style>
          <FontSize>8pt</FontSize>
          <FontWeight>700</FontWeight>
          <TextAlign>Center</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>21</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>2.3823cm</Left>
        <Height>0.44974cm</Height>
        <Value>Autoriza</Value>
      </Textbox>
      <Textbox Name="textbox35">
        <Top>17.61895cm</Top>
        <Width>16.26984cm</Width>
        <Style>
          <FontSize>8pt</FontSize>
          <TextAlign>Left</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>20</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>2.3823cm</Left>
        <Height>0.44974cm</Height>
        <Value />
      </Textbox>
      <Textbox Name="textbox36">
        <Top>17.27503cm</Top>
        <Width>16.26984cm</Width>
        <Style>
          <FontSize>8pt</FontSize>
          <TextAlign>Left</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>19</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>2.3823cm</Left>
        <Height>0.44974cm</Height>
        <Value>=IIF(First(Fields!OficioDePropuesta.Value, "dsOrdenDePres") &lt;&gt; "", "Propuesta: " + First(Fields!OficioDePropuesta.Value, "dsOrdenDePres"), "")</Value>
      </Textbox>
      <Textbox Name="textbox34">
        <Top>16.44171cm</Top>
        <Width>16.26984cm</Width>
        <Style>
          <FontSize>8pt</FontSize>
          <TextAlign>Left</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>18</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>3.51986cm</Left>
        <Height>0.44974cm</Height>
        <Value>ARCHIVO</Value>
      </Textbox>
      <Textbox Name="textbox33">
        <Top>16.09779cm</Top>
        <Width>16.26984cm</Width>
        <Style>
          <FontSize>8pt</FontSize>
          <TextAlign>Left</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>17</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>3.51986cm</Left>
        <Height>0.44974cm</Height>
        <Value>EXPEDIENTE</Value>
      </Textbox>
      <Textbox Name="textbox32">
        <Visibility>
          <Hidden>=IIF(First(Fields!IdSindicato.Value, "dsCopiaSindicato")="3",True,False)</Hidden>
        </Visibility>
        <Top>15.40995cm</Top>
        <Width>16.26984cm</Width>
        <Style>
          <FontSize>8pt</FontSize>
          <TextAlign>Left</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>16</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>3.51986cm</Left>
        <Height>0.44974cm</Height>
        <Value>=First(Fields!Profesion.Value, "dsCopiaSindicato") + " " + First(Fields!NomEmp.Value, "dsCopiaSindicato") + ".- " + First(Fields!Cargo.Value, "dsCopiaSindicato") +
".- Para su conocimiento."</Value>
      </Textbox>
      <Textbox Name="textbox31">
        <Top>15.75387cm</Top>
        <Width>16.26984cm</Width>
        <Style>
          <FontSize>8pt</FontSize>
          <TextAlign>Left</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>15</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>3.51986cm</Left>
        <Height>0.44974cm</Height>
        <Value>=First(Fields!Profesion.Value, "dsTitularCT") + " " + First(Fields!NomEmp.Value, "dsTitularCT") + ".- " + First(Fields!Cargo.Value, "dsTitularCT") +
".- Mismo Fin."</Value>
      </Textbox>
      <Textbox Name="textbox30">
        <Top>15.40995cm</Top>
        <Width>1.16402cm</Width>
        <Style>
          <FontSize>8pt</FontSize>
          <TextAlign>Center</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>14</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>2.3823cm</Left>
        <Height>0.44974cm</Height>
        <Value>C.c.p.</Value>
      </Textbox>
      <Textbox Name="textbox28">
        <Top>13.53164cm</Top>
        <Width>8.5cm</Width>
        <Style>
          <FontSize>9pt</FontSize>
          <FontWeight>700</FontWeight>
          <TextAlign>Center</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>13</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>2.3823cm</Left>
        <Height>0.44974cm</Height>
        <Value>=First(Fields!Profesion.Value, "dsFirmanteOP") + " " + First(Fields!DirectorAdmvo.Value, "dsFirmanteOP")</Value>
      </Textbox>
      <Textbox Name="textbox27">
        <Top>13.98138cm</Top>
        <Width>8.5cm</Width>
        <Style>
          <BorderStyle>
            <Top>Solid</Top>
          </BorderStyle>
          <FontSize>8pt</FontSize>
          <FontWeight>700</FontWeight>
          <TextAlign>Center</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>12</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>2.3823cm</Left>
        <Height>0.44974cm</Height>
        <Value>DIRECCIÓN ADMINISTRATIVA</Value>
      </Textbox>
      <Table Name="table2">
        <NoRows>Información del titular no disponible.</NoRows>
        <ZIndex>11</ZIndex>
        <DataSetName>dsEmpleadoTitular</DataSetName>
        <Top>5.68789cm</Top>
        <Width>17.55822cm</Width>
        <Details>
          <TableRows>
            <TableRow>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox21">
                      <Style>
                        <BackgroundColor>Silver</BackgroundColor>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontSize>8pt</FontSize>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <ZIndex>3</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value>Nombre:</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox22">
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontSize>8pt</FontSize>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <ZIndex>2</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value>=Fields!NomEmp.Value</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
              <Height>0.44974cm</Height>
            </TableRow>
            <TableRow>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox23">
                      <Style>
                        <BackgroundColor>Silver</BackgroundColor>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontSize>8pt</FontSize>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <ZIndex>1</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value>Motivo que origina interinato:</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox24">
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontSize>8pt</FontSize>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Value>=Fields!DescParaFormatos.Value</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
              <Height>0.44974cm</Height>
            </TableRow>
          </TableRows>
        </Details>
        <Header>
          <TableRows>
            <TableRow>
              <TableCells>
                <TableCell>
                  <ColSpan>2</ColSpan>
                  <ReportItems>
                    <Textbox Name="textbox29">
                      <Style>
                        <BackgroundColor>Silver</BackgroundColor>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontSize>9pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <ZIndex>4</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value>Información del titular de la carga horaria:</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
              <Height>0.44974cm</Height>
            </TableRow>
          </TableRows>
        </Header>
        <TableColumns>
          <TableColumn>
            <Width>5.17727cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>12.38095cm</Width>
          </TableColumn>
        </TableColumns>
        <Height>1.34922cm</Height>
        <Left>2.3823cm</Left>
      </Table>
      <Textbox Name="textbox20">
        <Top>2.53971cm</Top>
        <Width>17.53968cm</Width>
        <Style>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>10</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>2.3823cm</Left>
        <Height>0.44974cm</Height>
        <Value>="          Me permito comunicarle que ha sido " + IIF(First(Fields!Sexo.Value, "dsEmpleado")="H","designado","designada") +
" para cubrir " + Ucase(First(Fields!Nombramiento.Value, "dsEmpleado")) + " la siguiente carga horaria dentro del Colegio de Bachilleres del Estado de Veracruz en el periodo que abarca del " +
First(Fields!EfectoIni.Value, "dsEfectos") + " al " + First(Fields!EfectoFin.Value, "dsEfectos") + ", bajo las siguientes condiciones:"</Value>
      </Textbox>
      <Table Name="table1">
        <ZIndex>9</ZIndex>
        <DataSetName>dsCargaHorariaOP</DataSetName>
        <Top>3.22753cm</Top>
        <Width>17.55821cm</Width>
        <Details>
          <TableRows>
            <TableRow>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="NombreMateria">
                      <rd:DefaultName>NombreMateria</rd:DefaultName>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontSize>8pt</FontSize>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <ZIndex>3</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value>=Fields!NombreMateria.Value</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox56">
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontSize>8pt</FontSize>
                        <TextAlign>Center</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <ZIndex>2</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value>=Fields!Grupo.Value</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox12">
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontSize>8pt</FontSize>
                        <TextAlign>Center</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <ZIndex>1</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value>=Fields!Cantidad.Value</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox16">
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontSize>8pt</FontSize>
                        <TextAlign>Left</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Value>=Fields!DescCategoria.Value</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
              <Height>0.4cm</Height>
            </TableRow>
          </TableRows>
        </Details>
        <Header>
          <TableRows>
            <TableRow>
              <TableCells>
                <TableCell>
                  <ColSpan>2</ColSpan>
                  <ReportItems>
                    <Textbox Name="textbox11">
                      <rd:DefaultName>textbox11</rd:DefaultName>
                      <Style>
                        <BackgroundColor>Silver</BackgroundColor>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontSize>9pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <ZIndex>16</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value>Información sobre la carga horaria:</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox49">
                      <rd:DefaultName>textbox49</rd:DefaultName>
                      <Style>
                        <BackgroundColor>Silver</BackgroundColor>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>700</FontWeight>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <ZIndex>15</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value />
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox42">
                      <rd:DefaultName>textbox42</rd:DefaultName>
                      <Style>
                        <BackgroundColor>Silver</BackgroundColor>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>700</FontWeight>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <ZIndex>14</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value />
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
              <Height>0.44974cm</Height>
            </TableRow>
            <TableRow>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox26">
                      <rd:DefaultName>textbox26</rd:DefaultName>
                      <Style>
                        <BackgroundColor>Silver</BackgroundColor>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontSize>9pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <ZIndex>13</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value>Materia</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox41">
                      <rd:DefaultName>textbox41</rd:DefaultName>
                      <Style>
                        <BackgroundColor>Silver</BackgroundColor>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontSize>9pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <TextAlign>Center</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <ZIndex>12</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value>Grupos</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox50">
                      <rd:DefaultName>textbox50</rd:DefaultName>
                      <Style>
                        <BackgroundColor>Silver</BackgroundColor>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontSize>9pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <TextAlign>Center</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <ZIndex>11</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value>Horas por grupo</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox43">
                      <rd:DefaultName>textbox43</rd:DefaultName>
                      <Style>
                        <BackgroundColor>Silver</BackgroundColor>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontSize>9pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <ZIndex>10</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value>Categoría</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
              <Height>0.44974cm</Height>
            </TableRow>
          </TableRows>
        </Header>
        <TableColumns>
          <TableColumn>
            <Width>5.17727cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>4.49735cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>3.1746cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>4.70899cm</Width>
          </TableColumn>
        </TableColumns>
        <Height>2.19896cm</Height>
        <Footer>
          <TableRows>
            <TableRow>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox13">
                      <rd:DefaultName>textbox13</rd:DefaultName>
                      <Style>
                        <BackgroundColor>Silver</BackgroundColor>
                        <BorderColor>
                          <Right>Black</Right>
                        </BorderColor>
                        <BorderStyle>
                          <Default>Solid</Default>
                          <Right>Solid</Right>
                        </BorderStyle>
                        <BorderWidth>
                          <Right>1pt</Right>
                        </BorderWidth>
                        <FontWeight>700</FontWeight>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <ZIndex>7</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value />
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox14">
                      <Style>
                        <BackgroundColor>Silver</BackgroundColor>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontSize>9pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <TextAlign>Center</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <ZIndex>6</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value>Total horas</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox18">
                      <rd:DefaultName>textbox18</rd:DefaultName>
                      <Style>
                        <BackgroundColor>Silver</BackgroundColor>
                        <BorderColor>
                          <Right>Black</Right>
                        </BorderColor>
                        <BorderStyle>
                          <Default>Solid</Default>
                          <Right>Solid</Right>
                        </BorderStyle>
                        <BorderWidth>
                          <Right>1pt</Right>
                        </BorderWidth>
                        <FontSize>9pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <TextAlign>Center</TextAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <ZIndex>5</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value>=Sum(Fields!Cantidad.Value * Fields!Veces.Value)</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox19">
                      <rd:DefaultName>textbox19</rd:DefaultName>
                      <Style>
                        <BackgroundColor>Silver</BackgroundColor>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>700</FontWeight>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <ZIndex>4</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value />
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
              <Height>0.44974cm</Height>
            </TableRow>
            <TableRow>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox15">
                      <rd:DefaultName>textbox15</rd:DefaultName>
                      <Style>
                        <BackgroundColor>Silver</BackgroundColor>
                        <BorderColor>
                          <Right>Black</Right>
                        </BorderColor>
                        <BorderStyle>
                          <Default>Solid</Default>
                          <Right>Solid</Right>
                        </BorderStyle>
                        <BorderWidth>
                          <Right>1pt</Right>
                        </BorderWidth>
                        <FontSize>8pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <ZIndex>9</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value>Adscripción:</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ColSpan>3</ColSpan>
                  <ReportItems>
                    <Textbox Name="textbox17">
                      <rd:DefaultName>textbox17</rd:DefaultName>
                      <Style>
                        <BackgroundColor>Silver</BackgroundColor>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontSize>8pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <TextAlign>Left</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>1pt</PaddingRight>
                        <PaddingTop>1pt</PaddingTop>
                        <PaddingBottom>1pt</PaddingBottom>
                      </Style>
                      <ZIndex>8</ZIndex>
                      <CanGrow>true</CanGrow>
                      <Value>=First(Fields!NombreCT.Value, "dsTitularCT")</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
              <Height>0.44974cm</Height>
            </TableRow>
          </TableRows>
        </Footer>
        <Left>2.3823cm</Left>
      </Table>
      <Textbox Name="textbox10">
        <Top>11.79898cm</Top>
        <Width>9.44444cm</Width>
        <Style>
          <FontSize>9pt</FontSize>
          <FontWeight>700</FontWeight>
          <TextAlign>Center</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>8</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>6.07278cm</Left>
        <Height>0.44974cm</Height>
        <Value>A T E N T A M E N T E</Value>
      </Textbox>
      <Textbox Name="textbox9">
        <Top>9.52389cm</Top>
        <Width>17.53968cm</Width>
        <Style>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>7</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>2.3823cm</Left>
        <Height>0.44974cm</Height>
        <Value>="          Sin otro particular, quedo de usted."</Value>
      </Textbox>
      <Textbox Name="textbox8">
        <Top>8.8096cm</Top>
        <Width>17.53968cm</Width>
        <Style>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>6</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>2.3823cm</Left>
        <Height>0.44974cm</Height>
        <Value>="          Por lo que la presente tiene efectos formales de notificación en la fecha de conclusión del interinato."</Value>
      </Textbox>
      <Textbox Name="textbox7">
        <Top>8.06886cm</Top>
        <Width>17.53968cm</Width>
        <Style>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>5</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>2.3823cm</Left>
        <Height>0.44974cm</Height>
        <Value>="          Lo anterior, de conformidad con las cláusulas 30 y 35 del Contrato Colectivo del Trabajo que rigen las relaciones laborales entre los trabajadores y esta Entidad."</Value>
      </Textbox>
      <Textbox Name="textbox6">
        <Top>7.32811cm</Top>
        <Width>17.53968cm</Width>
        <Style>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>4</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>2.3823cm</Left>
        <Height>0.44974cm</Height>
        <Value>="          No omito indicarle que de reincorporarse el titular de la carga horaria, podrá usted ser " +
IIF(First(Fields!Sexo.Value, "dsEmpleado")="H","retirado","retirada") + ", sin responsabilidad para este Organismo."</Value>
      </Textbox>
      <Textbox Name="textbox4">
        <Top>1.64022cm</Top>
        <Width>9.44444cm</Width>
        <Style>
          <FontWeight>700</FontWeight>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>3</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>2.3823cm</Left>
        <Height>0.44974cm</Height>
        <Value>P r e s e n t e</Value>
      </Textbox>
      <Textbox Name="textbox3">
        <Top>1.24339cm</Top>
        <Width>9.44444cm</Width>
        <Style>
          <FontWeight>700</FontWeight>
          <TextAlign>Left</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>2</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>2.3823cm</Left>
        <Height>0.44974cm</Height>
        <Value>="C. " + First(Fields!NomEmp.Value, "dsEmpleado")</Value>
      </Textbox>
      <Textbox Name="textbox2">
        <Top>0.42328cm</Top>
        <Width>9.44444cm</Width>
        <Style>
          <TextAlign>Right</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <ZIndex>1</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>10.47754cm</Left>
        <Height>0.44974cm</Height>
        <Value>="Xalapa, Ver., a " + 
Day(First(Fields!FchParaOrdDePres.Value, "dsOrdenDePres")).ToString + " de " + 
UCase(Left(MonthName(Month(First(Fields!FchParaOrdDePres.Value, "dsOrdenDePres"))),1)) + 
LCase(Right(MonthName(Month(First(Fields!FchParaOrdDePres.Value, "dsOrdenDePres"))), Len(MonthName(Month(First(Fields!FchParaOrdDePres.Value, "dsOrdenDePres")))) - 1)) +
" de " + Year(First(Fields!FchParaOrdDePres.Value, "dsOrdenDePres")).ToString</Value>
      </Textbox>
      <Textbox Name="textbox1">
        <rd:DefaultName>textbox1</rd:DefaultName>
        <Top>0.02645cm</Top>
        <Width>9.44444cm</Width>
        <Style>
          <TextAlign>Right</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>1pt</PaddingLeft>
          <PaddingRight>1pt</PaddingRight>
          <PaddingTop>1pt</PaddingTop>
          <PaddingBottom>1pt</PaddingBottom>
        </Style>
        <CanGrow>true</CanGrow>
        <Left>10.47754cm</Left>
        <Height>0.44974cm</Height>
        <Value>="Orden de presentación RH.CBV" + 
IIF(First(Fields!NumRomanoZonaGeo.Value, "dsOrdenDePres")="","","." + First(Fields!NumRomanoZonaGeo.Value, "dsOrdenDePres")) +
"/" + First(Fields!NumOrdPres.Value, "dsOrdenDePres") + "/" + First(Fields!Ejercicio.Value, "dsOrdenDePres").ToString</Value>
      </Textbox>
    </ReportItems>
    <Height>21.64cm</Height>
    <Style>
      <BackgroundColor>White</BackgroundColor>
    </Style>
  </Body>
  <Language>es-MX</Language>
  <PageFooter>
    <PrintOnFirstPage>true</PrintOnFirstPage>
    <ReportItems>
      <Image Name="image2">
        <Sizing>Fit</Sizing>
        <Width>20cm</Width>
        <MIMEType />
        <Source>External</Source>
        <Style />
        <Left>0.795cm</Left>
        <Height>3.2cm</Height>
        <Value>footerformatos.png</Value>
      </Image>
    </ReportItems>
    <Height>3.3cm</Height>
    <PrintOnLastPage>true</PrintOnLastPage>
  </PageFooter>
  <PageHeight>27.94cm</PageHeight>
</Report>