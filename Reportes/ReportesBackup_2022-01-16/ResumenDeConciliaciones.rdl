<?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns:cl="http://schemas.microsoft.com/sqlserver/reporting/2010/01/componentdefinition" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Author>Fabio Rodríguez López</Author>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="Nomina">
      <DataSourceReference>/Data Sources/Nomina</DataSourceReference>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>5da0b2c8-9b04-4d2c-95bf-73e9abc7972a</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="dsResumenConciliaciones">
      <Query>
        <DataSourceName>Nomina</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@IdQuincena">
            <Value>=Parameters!pIdQuincena.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>Declare @TblFinalAux Table
(ClavePlantel Nvarchar(3) Null,
DescPlantel Nvarchar(50) Null,
ImportePR Decimal(9,2) Null,
ImporteRP Decimal(9,2) Null,
ImporteES Decimal(9,2) Null,
ImportePensionAlimenticia Decimal(9,2) Null,
ImportePensionAlimenticiaDeposito Decimal(9,2) Null,
ImporteNominas Decimal(9,2) Null,
ImporteRadicHaciaEste Decimal(9,2) Null,
ImporteRadicHaciaOtro Decimal(9,2) Null,
ImporteTotalPagos Decimal(9,2) Null,
ImporteBancomer Decimal(9,2) Null,
ImporteBanamex Decimal(9,2) Null,
ImporteBanorte Decimal(9,2) Null,
ImporteCheque Decimal(9,2) Null,
ImporteTotalRadicar Decimal(9,2),
ImporteTotalFlujo Decimal(9,2))

Declare @TblFinal Table
(ClavePlantel Nvarchar(3) Null,
DescPlantel Nvarchar(50) Null,
ImportePR Decimal(9,2) Null,
ImporteRP Decimal(9,2) Null,
ImporteES Decimal(9,2) Null,
ImportePensionAlimenticia Decimal(9,2) Null,
ImportePensionAlimenticiaDeposito Decimal(9,2) Null,
ImporteNominas Decimal(9,2) Null,
ImporteRadicHaciaEste Decimal(9,2) Null,
ImporteRadicHaciaOtro Decimal(9,2) Null,
ImporteTotalPagos Decimal(9,2) Null,
ImporteBancomer Decimal(9,2) Null,
ImporteBanamex Decimal(9,2) Null,
ImporteBanorte Decimal(9,2) Null,
ImporteCheque Decimal(9,2) Null,
ImporteTotalRadicar Decimal(9,2),
ImporteTotalFlujo Decimal(9,2))

Declare @Tbl1 Table
(IdPlaza Int,
IdEmp Int,
IdPlantel Smallint,
TipoNomina Nvarchar(2))

Insert Into @Tbl1
Select Distinct EP.IdPlaza, EP.IdEmp, EP.IdPlantel,
	Case FP.ClaveFondoPresup
		When 111 Then 'PR'
		When 113 Then 'ES'
		Else 'RP'
	End TipoNomina
From HistoriaPago HP
	Inner Join EmpleadosPlazas EP On EP.IdPlaza = HP.IdPlaza
	Inner Join TiposDeNominas TN On TN.IdTipoNomina = EP.IdTipoNomina
	Inner Join FondosPresupuestales FP On FP.IdFondoPresup = TN.IdFondoPresup
Where HP.IdQuincenaAplicacion = @IdQuincena And EP.PlazaEspecial = 0 And FP.ClaveFondoPresup = 111
UNION
Select Distinct EP.IdPlaza, EP.IdEmp, EP.IdPlantel,
	Case FP.ClaveFondoPresup
		When 111 Then 'PR'
		When 113 Then 'ES'
		Else 'RP'
	End TipoNomina
From HistoriaPago HP
	Inner Join EmpleadosPlazas EP On EP.IdPlaza = HP.IdPlaza
	Inner Join TiposDeNominas TN On TN.IdTipoNomina = EP.IdTipoNomina
	Inner Join FondosPresupuestales FP On FP.IdFondoPresup = TN.IdFondoPresup
Where HP.IdQuincenaAplicacion = @IdQuincena And EP.PlazaEspecial = 0 And FP.ClaveFondoPresup = 112
UNION
Select Distinct EP.IdPlaza, EP.IdEmp, EP.IdPlantel,
	Case FP.ClaveFondoPresup
		When 111 Then 'PR'
		When 113 Then 'ES'
		Else 'RP'
	End TipoNomina
From HistoriaPago HP
	Inner Join EmpleadosPlazas EP On EP.IdPlaza = HP.IdPlaza
	Inner Join TiposDeNominas TN On TN.IdTipoNomina = EP.IdTipoNomina
	Inner Join FondosPresupuestales FP On FP.IdFondoPresup = TN.IdFondoPresup
Where HP.IdQuincenaAplicacion = @IdQuincena And EP.PlazaEspecial = 0 And FP.ClaveFondoPresup = 113

INSERT INTO @TblFinalAux
Select ClavePlantel, LTRIM(RTRIM(DescPlantel)) DescPlantel,
	0 ImportePR, 0 ImporteRP, 0 ImporteES, 0 ImportePensionAlimenticia, 0 ImportePensionAlimenticiaDeposito,
	0 ImporteNominas, 0 ImporteRadicHaciaEste, 0 ImporteRadicHaciaOtro, 0 ImporteTotalPagos,
	0 ImporteBancomer, 0 ImporteBanamex, 0 ImporteBanorte,
	0 ImporteCheque, 0 ImporteTotalRadicar,
	0 ImporteTotalFlujo
From Planteles
Where @IdQuincena Between IdQnaIni And IdQnaFin

--Insert Into @TblFinalAux
UPDATE @TblFinalAux
SET ImportePR = T.ImportePR
FROM @TblFinalAux A
	INNER JOIN
(
Select P.ClavePlantel, P.DescPlantel, Sum(HPT.ImporteNeto) ImportePR, 0 ImporteRP, 0 ImporteES, 0 ImportePensionAlimenticia, 
	0 ImportePensionAlimenticiaDeposito, 0 ImporteNominas,
	0 ImporteRadicHaciaEste, 0 ImporteRadicHaciaOtro, 0 ImporteTotalPagos, 
	0 ImporteBancomer, 0 ImporteBanamex, 0 ImporteBanorte,
	0 ImporteCheque,
	0 ImporteTotalRadicar, 0 ImporteTotalFlujo
From @Tbl1 A
	Inner Join HistoriaPagoTotales HPT On HPT.IdEmp = A.IdEmp 
						AND HPT.IdQuincenaAplicacion = @IdQuincena
	Inner Join Planteles P On P.IdPlantel = A.IdPlantel
Where  A.TipoNomina = 'PR'
Group By P.ClavePlantel, P.DescPlantel, A.TipoNomina
) T ON T.ClavePlantel = A.ClavePlantel

--select * from @TblFinalAux
--order by ClavePlantel

--Insert Into @TblFinalAux
UPDATE @TblFinalAux
SET ImporteRP = T.ImporteRP
FROM @TblFinalAux A
	INNER JOIN
(
Select P.ClavePlantel, P.DescPlantel, 0 ImportePR, Sum(HPT.ImporteNeto) ImporteRP, 0 ImporteES, 0 ImportePensionAlimenticia, 
	0 ImportePensionAlimenticiaDeposito, 0 ImporteNominas,
	0 ImporteRadicHaciaEste, 0 ImporteRadicHaciaOtro, 0 ImporteTotalPagos, 
	0 ImporteBancomer, 0 ImporteBanamex, 0 ImporteBanorte,
	0 ImporteCheque, 
	0 ImporteTotalRadicar, 0 ImporteTotalFlujo
From @Tbl1 A
	Inner Join HistoriaPagoTotales HPT On HPT.IdEmp = A.IdEmp
	Left Join Planteles P On P.IdPlantel = A.IdPlantel
Where HPT.IdQuincenaAplicacion = @IdQuincena AND A.TipoNomina = 'RP'
Group By P.ClavePlantel, P.DescPlantel, A.TipoNomina
) T ON T.ClavePlantel = A.ClavePlantel

--&lt;&lt; CODIGO AGREGADO POR ALEXIS CORTEZ 2021/10/18 &gt;&gt;--

UPDATE @TblFinalAux
SET ImporteES = T.ImporteES
FROM @TblFinalAux A
	INNER JOIN
(
Select P.ClavePlantel, P.DescPlantel, 0 ImportePR, 0 ImporteRP, Sum(HPT.ImporteNeto) ImporteES, 0 ImportePensionAlimenticia, 
	0 ImportePensionAlimenticiaDeposito, 0 ImporteNominas,
	0 ImporteRadicHaciaEste, 0 ImporteRadicHaciaOtro, 0 ImporteTotalPagos, 
	0 ImporteBancomer, 0 ImporteBanamex, 0 ImporteBanorte,
	0 ImporteCheque,
	0 ImporteTotalRadicar, 0 ImporteTotalFlujo
From @Tbl1 A
	Inner Join HistoriaPagoTotales HPT On HPT.IdEmp = A.IdEmp 
						AND HPT.IdQuincenaAplicacion = @IdQuincena
	Inner Join Planteles P On P.IdPlantel = A.IdPlantel
Where  A.TipoNomina = 'ES'
Group By P.ClavePlantel, P.DescPlantel, A.TipoNomina
) T ON T.ClavePlantel = A.ClavePlantel


--&lt;&lt; CODIGO AGREGADO POR ALEXIS CORTEZ 2021/10/18 &gt;&gt;--

INSERT INTO @TblFinal
SELECT A.ClavePlantel, A.DescPlantel, 
	SUM(A.ImportePR) ImportePR, SUM(A.ImporteRP) ImporteRP, SUM(A.ImporteES) ImporteES,
	SUM(A.ImportePensionAlimenticia) ImportePensionAlimenticia,
	SUM(A.ImportePensionAlimenticiaDeposito) ImportePensionAlimenticiaDeposito,
	SUM(A.ImporteNominas) ImporteNominas,
	SUM(A.ImporteRadicHaciaEste) ImporteRadicHaciaEste,
	SUM(A.ImporteRadicHaciaOtro) ImporteRadicHaciaOtro,
	SUM(A.ImporteTotalPagos) ImporteTotalPagos,
	SUM(A.ImporteBancomer) ImporteBancomer,
	SUM(A.ImporteBanamex) ImporteBanamex,
	SUM(A.ImporteBanorte) ImporteBanorte,
	SUM(A.ImporteCheque) ImporteCheque,
	SUM(A.ImporteTotalRadicar) ImporteTotalRadicar,
	SUM(A.ImporteTotalFlujo) ImporteTotalFlujo
FROM @TblFinalAux A
GROUP BY A.ClavePlantel, A.DescPlantel


/*
If Not Exists
	(Select 1
	From @TblFinal
	Where ClavePlantel = '99')
	Begin
		Insert Into @TblFinal
		Select '99' ClavePlantel, 'ADMINISTRACION CENTRAL' DescPlantel, 0 ImportePR, 0 ImporteRP, 0 ImportePensionAlimenticia, 
		0 ImportePensionAlimenticiaDeposito, 0 ImporteNominas,
		0 ImporteRadicHaciaEste, 0 ImporteRadicHaciaOtro, 0 ImporteTotalPagos, 0 ImporteBancomer, 0 ImporteBanamex, 0 ImporteCheque,
		0 ImporteTotalRadicar, 0 ImporteTotalFlujo
	End

If Not Exists
	(Select 1
	From @TblFinal
	Where ClavePlantel = '13')
	Begin
		Insert Into @TblFinal
		Select '13' ClavePlantel, 'PLAYA VICENTE' DescPlantel, 0 ImportePR, 0 ImporteRP, 0 ImportePensionAlimenticia, 
		0 ImportePensionAlimenticiaDeposito, 0 ImporteNominas,
		0 ImporteRadicHaciaEste, 0 ImporteRadicHaciaOtro, 0 ImporteTotalPagos, 0 ImporteBancomer, 0 ImporteBanamex, 0 ImporteCheque,
		0 ImporteTotalRadicar, 0 ImporteTotalFlujo
	End
*/
--Delete From @Tbl1

--Insert Into @Tbl1
--Select Distinct EP.IdPlaza, EP.IdEmp, EP.IdPlantel,
--	Case FP.ClaveFondoPresup
--		When 111 Then 'PR'
--		Else 'RP'
--	End TipoNomina
--From HistoriaPago HP
--	Inner Join EmpleadosPlazas EP On EP.IdPlaza = HP.IdPlaza
--	Inner Join TiposDeNominas TN On TN.IdTipoNomina = EP.IdTipoNomina
--	Inner Join FondosPresupuestales FP On FP.IdFondoPresup = TN.IdFondoPresup
--Where HP.IdQuincenaAplicacion = @IdQuincena And EP.PlazaEspecial = 0 And FP.ClaveFondoPresup = 112

Update @TblFinal
Set ImporteRP = B.ImporteRP
From @TblFinal A
	Inner Join
			(Select P.ClavePlantel, Sum(HPT.ImporteNeto) ImporteRP
			From @Tbl1 A
				Inner Join HistoriaPagoTotales HPT On HPT.IdEmp = A.IdEmp
				Inner Join Planteles P On P.IdPlantel = A.IdPlantel
			Where HPT.IdQuincenaAplicacion = @IdQuincena AND A.TipoNomina = 'RP'
			Group By P.ClavePlantel, P.DescPlantel, A.TipoNomina) B On A.ClavePlantel = B.ClavePlantel

Declare @Tbl2 Table
(IdEmp Int,
IdPlantel Smallint)

Insert Into @Tbl2
Select Distinct EP.IdEmp, EP.IdPlantel
From HistoriaPago HP
	Inner Join EmpleadosPlazas EP On EP.IdPlaza = HP.IdPlaza
Where EP.PlazaEspecial = 0 And HP.IdQuincenaAplicacion = @IdQuincena

--Select P.ClavePlantel, Sum(HPA.Importe) ImportePensionAlimenticia
--From HistoriaPensionAlimenticia HPA
--	Inner Join BeneficiariosPensionAlimenticia BPA On BPA.IdBeneficiario = HPA.IdBeneficiario
--	Inner Join @Tbl2 A On A.IdEmp = BPA.IdEmp
--	Inner Join Planteles P On P.IdPlantel = BPA.IdPlantel
--Where HPA.IdQuincenaAplicacion = @IdQuincena and bpa.IdEmp = 1019
--Group By P.ClavePlantel
--return

Update @TblFinal
Set ImportePensionAlimenticia = B.ImportePensionAlimenticia
From @TblFinal A
	Inner Join
			(Select *
			From (
				Select P.ClavePlantel, Sum(HPA.Importe) ImportePensionAlimenticia
				From HistoriaPensionAlimenticia HPA
					Inner Join BeneficiariosPensionAlimenticia BPA On BPA.IdBeneficiario = HPA.IdBeneficiario
					Inner Join @Tbl2 A On A.IdEmp = BPA.IdEmp
					Inner Join Planteles P On P.IdPlantel = BPA.IdPlantel
				Where HPA.IdQuincenaAplicacion = @IdQuincena
				Group By P.ClavePlantel
				) T1) B On B.ClavePlantel = A.ClavePlantel

--SELECT * FROM @TblFinal A
--order by a.ClavePlantel
--RETURN

--343497.22 
--SELECT 2648.57 + 340848.65

Update @TblFinal
Set ImportePensionAlimenticiaDeposito = B.ImportePensionAlimenticia
From @TblFinal A
	Inner Join
			(Select *
			From (
				Select P.ClavePlantel, Sum(HPA.Importe) ImportePensionAlimenticia
				From HistoriaPensionAlimenticia HPA
					Inner Join BeneficiariosPensionAlimenticia BPA On BPA.IdBeneficiario = HPA.IdBeneficiario
					Inner Join @Tbl2 A On A.IdEmp = BPA.IdEmp
					Inner Join Planteles P On P.IdPlantel = BPA.IdPlantel
				Where HPA.IdQuincenaAplicacion = @IdQuincena 
					And (--BPA.IncluirEnPagomatico = 1 Or 
						IsNull(HPA.IncluirEnPagomatico,0) = 1
						Or IsNull(HPA.PagoInterbancario,0) = 1)
				Group By P.ClavePlantel
				) T1) B On B.ClavePlantel = A.ClavePlantel

Update @TblFinal
Set ImporteNominas = ImportePR + ImporteRP + ImporteES + ImportePensionAlimenticia

Delete From  @Tbl2

Insert Into @Tbl2
Select Distinct ECRDP.IdEmp, ECRDP.IdPlantel
From HistoriaPago HP
	Inner Join EmpleadosPlazas EP On EP.IdPlaza = HP.IdPlaza
	Inner Join EmpleadosConRadicacionesDePago ECRDP On ECRDP.IdEmp = EP.IdEmp
Where HP.IdQuincenaAplicacion = @IdQuincena And EP.PlazaEspecial = 0
	And EP.IdPlantel &lt;&gt; ECRDP.IdPlantel
	And Left(dbo.Fn_ObtenQnaPorId(@IdQuincena),6) Between Left(dbo.Fn_ObtenQnaPorId(ECRDP.IdQnaIni),6) And Left(dbo.Fn_ObtenQnaPorId(ECRDP.IdQnaFin),6)

Update @TblFinal
Set ImporteRadicHaciaEste = B.ImporteRadicHaciaEste
From @TblFinal A
	Inner Join 
			(Select P.ClavePlantel, B.ImporteRadicHaciaEste
			From (
				Select Distinct A.IdPlantel, Sum(HPT.ImporteNeto) ImporteRadicHaciaEste
				From @Tbl2 A
					Inner Join EmpleadosDatosLaborales EDL On EDL.IdEmp = A.IdEmp
					Inner Join HistoriaPagoTotales HPT On HPT.IdEmp = A.IdEmp
				Where HPT.IdQuincenaAplicacion = @IdQuincena 
				Group By A.IdPlantel
				) B
				Inner Join Planteles P On P.IdPlantel = B.IdPlantel
			) B On B.ClavePlantel = A.ClavePlantel

Delete From  @Tbl2

Insert Into @Tbl2
Select Distinct EP.IdEmp, EP.IdPlantel
From HistoriaPago HP
	Inner Join EmpleadosPlazas EP On EP.IdPlaza = HP.IdPlaza
	Inner Join EmpleadosConRadicacionesDePago ECRDP On ECRDP.IdEmp = EP.IdEmp
Where HP.IdQuincenaAplicacion = @IdQuincena And EP.PlazaEspecial = 0
	And EP.IdPlantel &lt;&gt; ECRDP.IdPlantel
	And Left(dbo.Fn_ObtenQnaPorId(@IdQuincena),6) Between Left(dbo.Fn_ObtenQnaPorId(ECRDP.IdQnaIni),6) And Left(dbo.Fn_ObtenQnaPorId(ECRDP.IdQnaFin),6)

Update @TblFinal
Set ImporteRadicHaciaOtro = B.ImporteRadicHaciaOtro
From @TblFinal A
	Inner Join 
			(
			Select P.ClavePlantel, A.ImporteRadicHaciaOtro
			From (
				Select Distinct A.IdPlantel, Sum(HPT.ImporteNeto) ImporteRadicHaciaOtro
				From @Tbl2 A
					Inner Join EmpleadosDatosLaborales EDL On EDL.IdEmp = A.IdEmp
					Inner Join HistoriaPagoTotales HPT On HPT.IdEmp = A.IdEmp
				Where HPT.IdQuincenaAplicacion = @IdQuincena 
				Group By A.IdPlantel
				) A
				Inner Join Planteles P On P.IdPlantel = A.IdPlantel
			) B On B.ClavePlantel = A.ClavePlantel

Update @TblFinal
Set ImporteTotalPagos = ImporteNominas + ImporteRadicHaciaEste - ImporteRadicHaciaOtro

Delete From @Tbl2

Insert Into @Tbl2
Select Distinct EP.IdEmp, EP.IdPlantel
From HistoriaPago HP
	Inner Join EmpleadosPlazas EP On EP.IdPlaza = HP.IdPlaza
Where HP.IdQuincenaAplicacion = @IdQuincena And EP.PlazaEspecial = 0

Declare @TblBancos Table
(ClavePlantel Nvarchar(3),
IdBanco Tinyint,
NombreCortoBanco Nvarchar(20),
TotalBanco Decimal(9,2))

Insert Into @TblBancos

Select ClavePlantel, IdBanco, NombreCortoBanco, Sum(TotalBanco) TotalBanco
From (
	Select P.ClavePlantel, HPT.IdBanco, LTRIM(RTRIM(B.NombreCortoBanco)) NombreCortoBanco, Sum(HPT.ImporteNeto) TotalBanco
	From @Tbl2 A
		Inner Join HistoriaPagoTotales HPT On HPT.IdEmp = A.IdEmp
		Inner Join Bancos B On B.Idbanco = HPT.IdBanco
		Inner Join Planteles P On P.IdPlantel = A.IdPlantel
	Where HPT.IdQuincenaAplicacion = @IdQuincena
		And (HPT.IncluirEnPagomatico = 1) And (LTrim(RTrim(HPT.CuentaBancaria)) &lt;&gt; ''
		Or HPT.CuentaBancaria Is Not Null)
	Group By P.ClavePlantel, HPT.IdBanco, B.NombreCortoBanco
	Union
	Select P.ClavePlantel, HPA.IdBanco, LTRIM(RTRIM(B.NombreCortoBanco)) NombreCortoBanco, Sum(HPA.Importe) TotalBanco
	From HistoriaPensionAlimenticia HPA
		Inner Join BeneficiariosPensionAlimenticia BPA On BPA.IdBeneficiario = HPA.IdBeneficiario
		Inner Join @Tbl2 A On A.IdEmp = BPA.IdEmp
		Inner Join Planteles P On P.IdPlantel = A.IdPlantel
		Inner Join Bancos B On B.Idbanco = HPA.IdBanco
	Where HPA.IdQuincenaAplicacion = @IdQuincena
		And (--BPA.IncluirEnPagomatico = 1 Or 
			IsNull(HPA.IncluirEnPagomatico,0) = 1
			Or IsNull(HPA.PagoInterbancario,0) = 1)
	Group By P.ClavePlantel, HPA.IdBanco, B.NombreCortoBanco
	) T
Group By ClavePlantel, IdBanco, NombreCortoBanco
--select * from @TblBancos
--RETURN
Update @TblFinal
Set ImporteBanamex = B.TotalBanco
From @TblFinal A
	Inner Join @TblBancos B On B.ClavePlantel = A.ClavePlantel
Where B.IdBanco = 1

Update @TblFinal
Set ImporteBancomer = B.TotalBanco
From @TblFinal A
	Inner Join @TblBancos B On B.ClavePlantel = A.ClavePlantel
Where B.IdBanco = 2

Update @TblFinal
Set ImporteBanorte = B.TotalBanco
From @TblFinal A
	Inner Join @TblBancos B On B.ClavePlantel = A.ClavePlantel
Where B.IdBanco = 4

Delete From  @Tbl2
Insert Into @Tbl2
Select Distinct ECRDP.IdEmp, ECRDP.IdPlantel
From HistoriaPago HP
	Inner Join EmpleadosPlazas EP On EP.IdPlaza = HP.IdPlaza
	Inner Join EmpleadosConRadicacionesDePago ECRDP On ECRDP.IdEmp = EP.IdEmp
Where HP.IdQuincenaAplicacion = @IdQuincena And EP.PlazaEspecial = 0
	And EP.IdPlantel &lt;&gt; ECRDP.IdPlantel
	And Left(dbo.Fn_ObtenQnaPorId(@IdQuincena),6) Between Left(dbo.Fn_ObtenQnaPorId(ECRDP.IdQnaIni),6) And Left(dbo.Fn_ObtenQnaPorId(ECRDP.IdQnaFin),6)

Declare @Tbl3 Table
(IdEmp Int,
IdPlantel Smallint)

Insert Into @Tbl3
Select Distinct EP.IdEmp, EP.IdPlantel
From HistoriaPago HP
	Inner Join EmpleadosPlazas EP On EP.IdPlaza = HP.IdPlaza
Where HP.IdQuincenaAplicacion = @IdQuincena And EP.PlazaEspecial = 0

Update @TblFinal
Set ImporteCheque = B.ImporteCheque
From @TblFinal A
	Inner Join 
			(Select ClavePlantel, Sum(Total) ImporteCheque
			From (
				Select P.ClavePlantel, A.Total
				From (
					Select Distinct A.IdPlantel, Sum(HPT.ImporteNeto) Total
					From @Tbl2 A
						Inner Join EmpleadosDatosLaborales EDL On EDL.IdEmp = A.IdEmp
						Inner Join HistoriaPagoTotales HPT On HPT.IdEmp = A.IdEmp
					Where HPT.IdQuincenaAplicacion = @IdQuincena 
					Group By A.IdPlantel
					) A
					Inner Join Planteles P On P.IdPlantel = A.IdPlantel
				Union All
				Select P.ClavePlantel, A.Total
				From (
					Select Distinct A.IdPlantel, Sum(HPT.ImporteNeto) Total
					From @Tbl3 A
						Inner Join EmpleadosDatosLaborales EDL On EDL.IdEmp = A.IdEmp
						Inner Join HistoriaPagoTotales HPT On HPT.IdEmp = A.IdEmp
					Where HPT.IdQuincenaAplicacion = @IdQuincena
						And HPT.IncluirEnPagomatico = 0
						And A.IdEmp Not In
											(Select IdEmp
											From EmpleadosConRadicacionesDePago
											Where Left(dbo.Fn_ObtenQnaPorId(@IdQuincena),6) Between Left(dbo.Fn_ObtenQnaPorId(IdQnaIni),6) And Left(dbo.Fn_ObtenQnaPorId(IdQnaFin),6))
					Group By A.IdPlantel
					) A
					Inner Join Planteles P On P.IdPlantel = A.IdPlantel
					) T1
			Group By ClavePlantel
			) B On B.ClavePlantel = A.ClavePlantel

Update @TblFinal
Set ImporteTotalRadicar = (ImportePensionAlimenticia - ImportePensionAlimenticiaDeposito) + ImporteCheque

Update @TblFinal
Set ImporteTotalFlujo = ImporteBancomer + ImporteBanamex + ImporteBanorte + ImporteTotalRadicar

Select Sum(ImportePR) ImportePR, Sum(ImporteRP) ImporteRP, Sum(ImporteES) ImporteES, Sum(ImportePensionAlimenticia) ImportePensionAlimenticia,
           Sum(ImporteNominas) ImporteNominas, 
           Sum(ImporteBancomer) ImporteBancomer, 
           Sum(ImporteBanamex) ImporteBanamex,
           Sum(ImporteBanorte) ImporteBanorte,
           Sum(ImporteTotalRadicar) ImporteTotalRadicar, Sum(ImporteTotalFlujo) ImporteTotalFlujo
From @TblFinal</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="ImportePR">
          <DataField>ImportePR</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="ImporteRP">
          <DataField>ImporteRP</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="ImportePensionAlimenticia">
          <DataField>ImportePensionAlimenticia</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="ImporteES">
          <DataField>ImporteES</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="ImporteNominas">
          <DataField>ImporteNominas</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="ImporteBancomer">
          <DataField>ImporteBancomer</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="ImporteBanamex">
          <DataField>ImporteBanamex</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="ImporteTotalRadicar">
          <DataField>ImporteTotalRadicar</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="ImporteBanorte">
          <DataField>ImporteBanorte</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="ImporteTotalFlujo">
          <DataField>ImporteTotalFlujo</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="dsTitulo">
      <Query>
        <DataSourceName>Nomina</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@IdQuincena">
            <Value>=Parameters!pIdQuincena.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>Declare @Anio Smallint
Declare @Mes Tinyint
Declare @ParteQuincena Nvarchar(10)
Declare @NombreMes Nvarchar(15)
Declare @Adicional Tinyint
Declare @Observaciones Nvarchar(200)

SELECT @Anio = Anio,
	@Mes =
	Case Quincena % 2
		When 0 Then Quincena/2
		Else (Quincena + 1)/2
	End,
	@ParteQuincena =
	Case Quincena % 2
		When 0 Then 'SEGUNDA'
		Else 'PRIMERA'
	End, @Adicional = Adicional, @Observaciones = UPPER(Observaciones)
FROM Quincenas
Where IdQuincena = @IdQuincena

Select @NombreMes = UPPER(NombreMes)
From Meses
Where IdMes = @Mes

If @Adicional = 0
	Begin
		SELECT 'RESUMEN DE CONCILIACIONES CORRESPONDIENTE A LA ' + @ParteQuincena + ' QUINCENA DE ' + @NombreMes + ' DE ' + CONVERT(Nvarchar(4),@Anio) TITULONOMINA
	End
Else
	Begin
		SELECT 'RESUMEN DE CONCILIACIONES QUINCENA ' + dbo.Fn_ObtenQnaPorId(@IdQuincena) + ':  ' + @Observaciones + '. ' + @NombreMes + ' DE ' + CONVERT(Nvarchar(4),@Anio) TITULONOMINA
	End</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="TITULONOMINA">
          <DataField>TITULONOMINA</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="dsEmpresa">
      <SharedDataSet>
        <SharedDataSetReference>/Reportes/dsEmpresa</SharedDataSetReference>
      </SharedDataSet>
      <Fields>
        <Field Name="NombreEmpresa">
          <DataField>NombreEmpresa</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="OPD">
          <DataField>OPD</DataField>
          <rd:TypeName>System.Boolean</rd:TypeName>
        </Field>
        <Field Name="TextoOPD">
          <DataField>TextoOPD</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="table1">
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>4.1cm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>4.1cm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>4.1cm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>4.1cm</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>0.45cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox15">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>NÓMINA</Value>
                                  <Style>
                                    <FontFamily>Verdana</FontFamily>
                                    <FontSize>9pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox15</rd:DefaultName>
                          <ZIndex>10</ZIndex>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>Silver</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                        <ColSpan>3</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox8">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontFamily>Verdana</FontFamily>
                                    <FontSize>9pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox8</rd:DefaultName>
                          <ZIndex>9</ZIndex>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>Silver</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.45cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox3">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>PRESUPUESTO REGULAR</Value>
                                  <Style>
                                    <FontFamily>Verdana</FontFamily>
                                    <FontSize>9pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox3</rd:DefaultName>
                          <ZIndex>8</ZIndex>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>Silver</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox4">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>RECURSOS PROPIOS</Value>
                                  <Style>
                                    <FontFamily>Verdana</FontFamily>
                                    <FontSize>9pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox4</rd:DefaultName>
                          <ZIndex>7</ZIndex>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>Silver</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox24">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>ESTATAL</Value>
                                  <Style>
                                    <FontFamily>Verdana</FontFamily>
                                    <FontSize>9pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox24</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>Silver</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox5">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>PENSIÓN ALIMENTICIA</Value>
                                  <Style>
                                    <FontFamily>Verdana</FontFamily>
                                    <FontSize>9pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox5</rd:DefaultName>
                          <ZIndex>6</ZIndex>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>Silver</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.45cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ImportePR">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!ImportePR.Value</Value>
                                  <Style>
                                    <FontFamily>Verdana</FontFamily>
                                    <FontSize>9pt</FontSize>
                                    <Format>C</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>ImportePR</rd:DefaultName>
                          <ZIndex>2</ZIndex>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ImporteRP">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!ImporteRP.Value</Value>
                                  <Style>
                                    <FontFamily>Verdana</FontFamily>
                                    <FontSize>9pt</FontSize>
                                    <Format>C</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>ImporteRP</rd:DefaultName>
                          <ZIndex>1</ZIndex>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ImporteRP2">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!ImporteES.Value</Value>
                                  <Style>
                                    <FontFamily>Verdana</FontFamily>
                                    <FontSize>9pt</FontSize>
                                    <Format>C</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>ImporteRP</rd:DefaultName>
                          <ZIndex>1</ZIndex>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ImportePensionAlimenticia">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!ImportePensionAlimenticia.Value</Value>
                                  <Style>
                                    <FontFamily>Verdana</FontFamily>
                                    <FontSize>9pt</FontSize>
                                    <Format>C</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>ImportePensionAlimenticia</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.45cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox10">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontFamily>Verdana</FontFamily>
                                    <FontSize>9pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox10</rd:DefaultName>
                          <ZIndex>5</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox14">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontFamily>Verdana</FontFamily>
                                    <FontSize>9pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox10</rd:DefaultName>
                          <ZIndex>5</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox11">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>TOTAL</Value>
                                  <Style>
                                    <FontFamily>Verdana</FontFamily>
                                    <FontSize>9pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox11</rd:DefaultName>
                          <ZIndex>4</ZIndex>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>Silver</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ImporteNominas">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!ImporteNominas.Value)</Value>
                                  <Style>
                                    <FontFamily>Verdana</FontFamily>
                                    <FontSize>9pt</FontSize>
                                    <Format>C</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>ImporteNominas</rd:DefaultName>
                          <ZIndex>3</ZIndex>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <Group Name="table1_Details_Group">
                    <DataElementName>Detail</DataElementName>
                  </Group>
                  <TablixMembers>
                    <TablixMember />
                  </TablixMembers>
                  <DataElementName>Detail_Collection</DataElementName>
                  <DataElementOutput>Output</DataElementOutput>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>Before</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>dsResumenConciliaciones</DataSetName>
            <Top>0.45cm</Top>
            <Left>1.595cm</Left>
            <Height>1.8cm</Height>
            <Width>16.4cm</Width>
            <Style>
              <FontFamily>Verdana</FontFamily>
              <VerticalAlign>Middle</VerticalAlign>
            </Style>
          </Tablix>
          <Tablix Name="table2">
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>5.58167cm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>5.39646cm</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>0.45cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox16">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>DEPÓSITOS BANCARIOS</Value>
                                  <Style>
                                    <FontFamily>Verdana</FontFamily>
                                    <FontSize>9pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>10</ZIndex>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>Silver</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox9">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontFamily>Verdana</FontFamily>
                                    <FontSize>9pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox9</rd:DefaultName>
                          <ZIndex>9</ZIndex>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>Silver</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.45cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox14">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>BANORTE</Value>
                                  <Style>
                                    <FontFamily>Verdana</FontFamily>
                                    <FontSize>9pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox14</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>Silver</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox19">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>TOTAL RADICACIÓN</Value>
                                  <Style>
                                    <FontFamily>Verdana</FontFamily>
                                    <FontSize>9pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>6</ZIndex>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>Silver</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.45cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ImporteBanorte">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!ImporteBanorte.Value</Value>
                                  <Style>
                                    <FontSize>9pt</FontSize>
                                    <Format>C</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>ImporteBanorte</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ImporteTotalRadicar">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!ImporteTotalRadicar.Value</Value>
                                  <Style>
                                    <FontSize>9pt</FontSize>
                                    <Format>C</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>ImporteTotalRadicar</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.45cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox21">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>TOTAL</Value>
                                  <Style>
                                    <FontFamily>Verdana</FontFamily>
                                    <FontSize>9pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>4</ZIndex>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>Silver</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox22">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!ImporteTotalFlujo.Value)</Value>
                                  <Style>
                                    <FontFamily>Verdana</FontFamily>
                                    <FontSize>9pt</FontSize>
                                    <Format>C</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>3</ZIndex>
                          <Style>
                            <Border>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember />
                <TablixMember />
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <Group Name="table2_Details_Group">
                    <DataElementName>Detail</DataElementName>
                  </Group>
                  <TablixMembers>
                    <TablixMember />
                  </TablixMembers>
                  <DataElementName>Detail_Collection</DataElementName>
                  <DataElementOutput>Output</DataElementOutput>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>Before</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>dsResumenConciliaciones</DataSetName>
            <Top>2.7cm</Top>
            <Left>4.21333cm</Left>
            <Height>1.8cm</Height>
            <Width>10.97813cm</Width>
            <ZIndex>1</ZIndex>
            <Style>
              <FontFamily>Verdana</FontFamily>
              <VerticalAlign>Middle</VerticalAlign>
            </Style>
          </Tablix>
        </ReportItems>
        <Height>4.5cm</Height>
        <Style />
      </Body>
      <Width>19.59cm</Width>
      <Page>
        <PageHeader>
          <Height>1.525cm</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <ReportItems>
            <Textbox Name="textbox2">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=First(Fields!NombreEmpresa.Value, "dsEmpresa")</Value>
                      <Style>
                        <FontFamily>Verdana</FontFamily>
                        <FontSize>11pt</FontSize>
                        <FontWeight>Bold</FontWeight>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Center</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>textbox2</rd:DefaultName>
              <Left>3.4325cm</Left>
              <Height>0.6cm</Height>
              <Width>12.725cm</Width>
              <Style>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
            <Textbox Name="textbox12">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=First(Fields!TextoOPD.Value, "dsEmpresa")</Value>
                      <Style>
                        <FontFamily>Verdana</FontFamily>
                        <FontWeight>Bold</FontWeight>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Center</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Top>0.45cm</Top>
              <Left>4.67cm</Left>
              <Height>0.525cm</Height>
              <Width>10.25cm</Width>
              <ZIndex>1</ZIndex>
              <Style>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
            <Textbox Name="textbox13">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=Parameters!pTituloNomina.Value</Value>
                      <Style>
                        <FontFamily>Verdana</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Center</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Top>0.9cm</Top>
              <Left>0.87cm</Left>
              <Height>0.525cm</Height>
              <Width>17.85cm</Width>
              <ZIndex>2</ZIndex>
              <Style>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
          </ReportItems>
          <Style>
            <BottomBorder>
              <Style>Solid</Style>
            </BottomBorder>
          </Style>
        </PageHeader>
        <PageFooter>
          <Height>1.04cm</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <ReportItems>
            <Textbox Name="textbox1">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>="Hoja: " + Globals!PageNumber.ToString + "/ " + Globals!TotalPages.ToString</Value>
                      <Style>
                        <FontFamily>Verdana</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>textbox1</rd:DefaultName>
              <Top>0.25cm</Top>
              <Left>13.745cm</Left>
              <Height>0.5cm</Height>
              <Width>5.55cm</Width>
              <Style>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
            <Textbox Name="textbox7">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>="Fecha: " + Today</Value>
                      <Style>
                        <FontFamily>Verdana</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Left</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Top>0.25cm</Top>
              <Left>0.295cm</Left>
              <Height>0.5cm</Height>
              <Width>5.75cm</Width>
              <ZIndex>1</ZIndex>
              <Style>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
          </ReportItems>
          <Style />
        </PageFooter>
        <PageHeight>27.94cm</PageHeight>
        <PageWidth>21.59cm</PageWidth>
        <LeftMargin>1cm</LeftMargin>
        <RightMargin>1cm</RightMargin>
        <TopMargin>0.5cm</TopMargin>
        <BottomMargin>0.5cm</BottomMargin>
        <ColumnSpacing>1cm</ColumnSpacing>
        <Style>
          <BackgroundColor>White</BackgroundColor>
        </Style>
      </Page>
    </ReportSection>
  </ReportSections>
  <ReportParameters>
    <ReportParameter Name="pIdQuincena">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>1581</Value>
        </Values>
      </DefaultValue>
      <Prompt>IdQuincena</Prompt>
    </ReportParameter>
    <ReportParameter Name="pTituloNomina">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>dsTitulo</DataSetName>
          <ValueField>TITULONOMINA</ValueField>
        </DataSetReference>
      </DefaultValue>
      <AllowBlank>true</AllowBlank>
      <Hidden>true</Hidden>
    </ReportParameter>
  </ReportParameters>
  <Code>Public dim nombrevariable as String = ""

Public dim i as Integer = 0

Public Function FncCampoCabecera(byval valorCampo as String) as String
i = i  + 1
if i = 1 then
nombrevariable = valorCampo
end if
return nombrevariable
End Function</Code>
  <Language>es-MX</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportServerUrl>http://s-rec-hum/ReportServer_SQLSRV2008R2</rd:ReportServerUrl>
  <rd:ReportID>e6fc191f-b535-49e3-9ce0-5059c5831c55</rd:ReportID>
</Report>